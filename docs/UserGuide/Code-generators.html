
<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="author" content="John T. O’Donnell" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="Sigma16 system documentation" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sigma16 User Guide — Code generators</title>
<link rel="stylesheet" type="text/css" href="lwarp.css" />

<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
// \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
    subequations: "0",
    section: "",
    loader: {
        load: ['[tex]/tagformat', '[tex]/textmacros'],
    },
    startup: {
        ready() {
            //      These would be replaced by import commands if you wanted to make
            //      a proper extension.
            const Configuration = MathJax._.input.tex.Configuration.Configuration;
            const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
            const Macro = MathJax._.input.tex.Symbol.Macro;
            const TexError = MathJax._.input.tex.TexError.default;
            const ParseUtil = MathJax._.input.tex.ParseUtil.default;
            const expandable = MathJax._.util.Options.expandable;


            //      Insert the replacement string into the TeX string, and check
            //      that there haven't been too many maxro substitutions (prevents
            //      infinite loops).
            const useArgument = (parser, text) => {
                parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
                parser.i = 0;
                if (++parser.macroCount > parser.configuration.options.maxMacros) {
                    throw new TexError('MaxMacroSub1',
                    'MathJax maximum macro substitution count exceeded; ' +
                    'is there a recursive macro call?');
                }
            }


            //      Create the command map for:
            //          \ifstar, \ifnextchar, \ifblank, \ifstrequal, \gsub, \seteqnumber
            new CommandMap('Lwarp-macros', {
                ifstar: 'IfstarFunction',
                ifnextchar: 'IfnextcharFunction',
                ifblank: 'IfblankFunction',
                ifstrequal: 'IfstrequalFunction',
                gsubstitute: 'GsubstituteFunction',
                seteqnumber: 'SeteqnumberFunction'
            }, {
                //      This function implements an ifstar macro.
                IfstarFunction(parser, name) {
                    const resultstar = parser.GetArgument(name);
                    const resultnostar = parser.GetArgument(name);
                    const star = parser.GetStar();                      // true if there is a *
                    useArgument(parser, star ? resultstar : resultnostar);
                },


                //      This function implements an ifnextchar macro.
                IfnextcharFunction(parser, name) {
                    let whichchar = parser.GetArgument(name);
                    if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                        // $ syntax highlighting
                        whichchar = String.fromCodePoint(parseInt(whichchar));
                    }
                    const resultnextchar = parser.GetArgument(name);
                    const resultnotnextchar = parser.GetArgument(name);
                    const gotchar = (parser.GetNext() === whichchar);
                    useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
                },


                // This function implements an ifblank macro.
                IfblankFunction(parser, name) {
                    const blankarg = parser.GetArgument(name);
                    const resultblank = parser.GetArgument(name);
                    const resultnotblank = parser.GetArgument(name);
                    const isblank = (blankarg.trim() == "");
                    useArgument(parser, isblank ? resultblank : resultnotblank);
                },


                // This function implements an ifstrequal macro.
                IfstrequalFunction(parser, name) {
                    const strequalfirst = parser.GetArgument(name);
                    const strequalsecond = parser.GetArgument(name);
                    const resultequal = parser.GetArgument(name);
                    const resultnotequal = parser.GetArgument(name);
                    const isequal = (strequalfirst == strequalsecond);
                    useArgument(parser, isequal ? resultequal : resultnotequal);
                },


                // This function implements a gsub macro.
                GsubstituteFunction(parser, name) {
                    const gsubfirst = parser.GetArgument(name);
                    const gsubsecond = parser.GetArgument(name);
                    const gsubthird = parser.GetArgument(name);
                    let gsubresult=gsubfirst.replace(gsubsecond, gsubthird);
                    useArgument(parser, gsubresult);
                },


                //      This function modifies the equation numbers.
                SeteqnumberFunction(parser, name) {
                        //   Get the macro parameters
                        const star = parser.GetStar();                    // true if there is a *
                        const optBrackets = parser.GetBrackets(name);     // contents of optional brackets
                        const newsubequations = parser.GetArgument(name);    // the subequations argument
                        const neweqsection = parser.GetArgument(name);    // the eq section argument
                        const neweqnumber = parser.GetArgument(name);     // the eq number argument
                        MathJax.config.subequations=newsubequations ;     // a string with boolean meaning
                        MathJax.config.section=neweqsection ;             // a string with numeric meaning
                        parser.tags.counter = parser.tags.allCounter = neweqnumber ;
                }


            });


            //      Create the Lwarp-macros package
            Configuration.create('Lwarp-macros', {
                handler: {macro: ['Lwarp-macros']}
            });


            MathJax.startup.defaultReady();


            // For forward references:
            MathJax.startup.input[0].preFilters.add(({math}) => {
                if (math.inputData.recompile){
                        MathJax.config.subequations = math.inputData.recompile.subequations;
                        MathJax.config.section = math.inputData.recompile.section;
                }
            });
            MathJax.startup.input[0].postFilters.add(({math}) => {
                if (math.inputData.recompile){
                        math.inputData.recompile.subequations = MathJax.config.subequations;
                        math.inputData.recompile.section = MathJax.config.section;
                }
            });


                // For \left, \right with unicode-math:
                const {DelimiterMap} = MathJax._.input.tex.SymbolMap;
                const {Symbol} = MathJax._.input.tex.Symbol;
                const {MapHandler} = MathJax._.input.tex.MapHandler;
                const delimiter = MapHandler.getMap('delimiter');
                delimiter.add('\\lBrack', new Symbol('\\lBrack', '\u27E6'));
                delimiter.add('\\rBrack', new Symbol('\\rBrack', '\u27E7'));
                delimiter.add('\\lAngle', new Symbol('\\lAngle', '\u27EA'));
                delimiter.add('\\rAngle', new Symbol('\\rAngle', '\u27EB'));
                delimiter.add('\\lbrbrak', new Symbol('\\lbrbrak', '\u2772'));
                delimiter.add('\\rbrbrak', new Symbol('\\rbrbrak', '\u2773'));
                delimiter.add('\\lbag', new Symbol('\\lbag', '\u27C5'));
                delimiter.add('\\rbag', new Symbol('\\rbag', '\u27C6'));
                delimiter.add('\\llparenthesis', new Symbol('\\llparenthesis', '\u2987'));
                delimiter.add('\\rrparenthesis', new Symbol('\\rrparenthesis', '\u2988'));
                delimiter.add('\\llangle', new Symbol('\\llangle', '\u2989'));
                delimiter.add('\\rrangle', new Symbol('\\rrangle', '\u298A'));
                delimiter.add('\\Lbrbrak', new Symbol('\\Lbrbrak', '\u27EC'));
                delimiter.add('\\Rbrbrak', new Symbol('\\Rbrbrak', '\u27ED'));
                delimiter.add('\\lBrace', new Symbol('\\lBrace', '\u2983'));
                delimiter.add('\\rBrace', new Symbol('\\rBrace', '\u2984'));
                delimiter.add('\\lParen', new Symbol('\\lParen', '\u2985'));
                delimiter.add('\\rParen', new Symbol('\\rParen', '\u2986'));
                delimiter.add('\\lbrackubar', new Symbol('\\lbrackubar', '\u298B'));
                delimiter.add('\\rbrackubar', new Symbol('\\rbrackubar', '\u298C'));
                delimiter.add('\\lbrackultick', new Symbol('\\lbrackultick', '\u298D'));
                delimiter.add('\\rbracklrtick', new Symbol('\\rbracklrtick', '\u298E'));
                delimiter.add('\\lbracklltick', new Symbol('\\lbracklltick', '\u298F'));
                delimiter.add('\\rbrackurtick', new Symbol('\\rbrackurtick', '\u2990'));
                delimiter.add('\\langledot', new Symbol('\\langledot', '\u2991'));
                delimiter.add('\\rangledot', new Symbol('\\rangledot', '\u2992'));
                delimiter.add('\\lparenless', new Symbol('\\lparenless', '\u2993'));
                delimiter.add('\\rparengtr', new Symbol('\\rparengtr', '\u2994'));
                delimiter.add('\\Lparengtr', new Symbol('\\Lparengtr', '\u2995'));
                delimiter.add('\\Rparenless', new Symbol('\\Rparenless', '\u2996'));
                delimiter.add('\\lblkbrbrak', new Symbol('\\lblkbrbrak', '\u2997'));
                delimiter.add('\\rblkbrbrak', new Symbol('\\rblkbrbrak', '\u2998'));
                delimiter.add('\\lvzigzag', new Symbol('\\lvzigzag', '\u29D8'));
                delimiter.add('\\rvzigzag', new Symbol('\\rvzigzag', '\u29D9'));
                delimiter.add('\\Lvzigzag', new Symbol('\\Lvzigzag', '\u29DA'));
                delimiter.add('\\Rvzigzag', new Symbol('\\Rvzigzag', '\u29DB'));
                delimiter.add('\\lcurvyangle', new Symbol('\\lcurvyangle', '\u29FC'));
                delimiter.add('\\rcurvyangle', new Symbol('\\rcurvyangle', '\u29FD'));
                delimiter.add('\\Vvert', new Symbol('\\Vvert', '\u2980'));
        }        // ready
    },           // startup


    tex: {
        packages: {'[+]': ['tagformat', 'Lwarp-macros', 'textmacros']},
        tags: "ams",
                tagformat: {
                        number: function (n) {
                             if(MathJax.config.subequations==0)
                                 return(MathJax.config.section + n);
                             else
                                 return(MathJax.config.section + String.fromCharCode(96+n));
                        },
                },
    }
}
</script>


<script
        id="MathJax-script"
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>

</head>
<body>


<a id="Sigma16UserGuide-autopage-365"></a>
<nav class="topnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>


<div class="bodyandsidetoc">
<div class="sidetoccontainer">


<nav class="sidetoc">


<div class="sidetoctitle">

<p>
<span class="sidetocthetitle">Sigma16 User Guide</span>
</p>

<p>
Contents
</p>
</div>


<div class="sidetoccontents">

<p>
<a href="index.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="Introduction.html#autosec-5" class="tocsection" >
<span class="sectionnumber">1</span>&#x2003;Introduction</a>
</p>


<p>
<a href="Core-architecture-tutorials.html#autosec-7" class="tocsection" >
<span class="sectionnumber">2</span>&#x2003;Core architecture tutorials</a>
</p>


<p>
<a href="Core-architecture-tutorials.html#autosec-8" class="tocsubsection" >
<span class="sectionnumber">2.1</span>&#x2003;Hello, world!</a>
</p>


<p>
<a href="A-quick-tour.html#autosec-10" class="tocsubsection" >
<span class="sectionnumber">2.2</span>&#x2003;A quick tour</a>
</p>


<p>
<a href="Registers-constants-arithmetic.html#autosec-12" class="tocsubsection" >
<span class="sectionnumber">2.3</span>&#x2003;Registers, constants, and arithmetic</a>
</p>


<p>
<a href="Keeping-variables-in-memory.html#autosec-27" class="tocsubsection" >
<span class="sectionnumber">2.4</span>&#x2003;Keeping variables in memory</a>
</p>


<p>
<a href="Assembly-language.html#autosec-32" class="tocsubsection" >
<span class="sectionnumber">2.5</span>&#x2003;Assembly language</a>
</p>


<p>
<a href="Editing-files.html#autosec-41" class="tocsubsection" >
<span class="sectionnumber">2.6</span>&#x2003;Editing files</a>
</p>


<p>
<a href="Jumps-conditionals.html#autosec-43" class="tocsubsection" >
<span class="sectionnumber">2.7</span>&#x2003;Jumps and conditionals</a>
</p>


<p>
<a href="Loops.html#autosec-58" class="tocsubsection" >
<span class="sectionnumber">2.8</span>&#x2003;Loops</a>
</p>


<p>
<a href="Machine-language.html#autosec-65" class="tocsubsection" >
<span class="sectionnumber">2.9</span>&#x2003;Machine language</a>
</p>


<p>
<a href="Pseudoinstructions.html#autosec-72" class="tocsubsection" >
<span class="sectionnumber">2.10</span>&#x2003;Pseudoinstructions</a>
</p>


<p>
<a href="A-strange-program.html#autosec-76" class="tocsubsection" >
<span class="sectionnumber">2.11</span>&#x2003;A strange program</a>
</p>


<p>
<a href="Breakpoints.html#autosec-79" class="tocsubsection" >
<span class="sectionnumber">2.12</span>&#x2003;Breakpoints</a>
</p>


<p>
<a href="Summary-core-instruction-formats.html#autosec-86" class="tocsubsection" >
<span class="sectionnumber">2.13</span>&#x2003;Summary of core instruction formats</a>
</p>


<p>
<a href="Summary-core-instructions.html#autosec-91" class="tocsubsection" >
<span class="sectionnumber">2.14</span>&#x2003;Summary of core instructions</a>
</p>


<p>
<a href="Standard-architecture-tutorials.html#autosec-93" class="tocsection" >
<span class="sectionnumber">3</span>&#x2003;Standard architecture tutorials</a>
</p>


<p>
<a href="Standard-architecture-tutorials.html#autosec-94" class="tocsubsection" >
<span class="sectionnumber">3.1</span>&#x2003;Logic</a>
</p>


<p>
<a href="Shifting.html#autosec-97" class="tocsubsection" >
<span class="sectionnumber">3.2</span>&#x2003;Shifting</a>
</p>


<p>
<a href="Bit-fields.html#autosec-101" class="tocsubsection" >
<span class="sectionnumber">3.3</span>&#x2003;Bit fields</a>
</p>


<p>
<a href="Saving-registers-procedure-call.html#autosec-107" class="tocsubsection" >
<span class="sectionnumber">3.4</span>&#x2003;Saving registers for procedure call</a>
</p>


<p>
<a href="Branching-pc-relative-address.html#autosec-111" class="tocsubsection" >
<span class="sectionnumber">3.5</span>&#x2003;Branching to pc-relative address</a>
</p>


<p>
<a href="Stack-instructions.html#autosec-113" class="tocsubsection" >
<span class="sectionnumber">3.6</span>&#x2003;Stack instructions</a>
</p>


<p>
<a href="Arithmetic-on-natural-numbers.html#autosec-115" class="tocsubsection" >
<span class="sectionnumber">3.7</span>&#x2003;Arithmetic on natural numbers</a>
</p>


<p>
<a href="Modules-linking.html#autosec-117" class="tocsubsection" >
<span class="sectionnumber">3.8</span>&#x2003;Modules and linking</a>
</p>


<p>
<a href="System-control-registers.html#autosec-119" class="tocsubsection" >
<span class="sectionnumber">3.9</span>&#x2003;System control registers</a>
</p>


<p>
<a href="Interrupts.html#autosec-121" class="tocsubsection" >
<span class="sectionnumber">3.10</span>&#x2003;Interrupts</a>
</p>


<p>
<a href="The-Sigma16-architecture.html#autosec-123" class="tocsection" >
<span class="sectionnumber">4</span>&#x2003;The Sigma16 architecture</a>
</p>


<p>
<a href="The-Sigma16-architecture.html#autosec-124" class="tocsubsection" >
<span class="sectionnumber">4.1</span>&#x2003;Implementations</a>
</p>


<p>
<a href="Subsystems.html#autosec-126" class="tocsubsection" >
<span class="sectionnumber">4.2</span>&#x2003;Subsystems</a>
</p>


<p>
<a href="Words.html#autosec-128" class="tocsubsection" >
<span class="sectionnumber">4.3</span>&#x2003;Words</a>
</p>


<p>
<a href="Memory.html#autosec-139" class="tocsubsection" >
<span class="sectionnumber">4.4</span>&#x2003;Memory</a>
</p>


<p>
<a href="Registers.html#autosec-141" class="tocsubsection" >
<span class="sectionnumber">4.5</span>&#x2003;Registers</a>
</p>


<p>
<a href="Instruction-representation.html#autosec-158" class="tocsubsection" >
<span class="sectionnumber">4.6</span>&#x2003;Instruction representation</a>
</p>


<p>
<a href="Instruction-set.html#autosec-182" class="tocsection" >
<span class="sectionnumber">5</span>&#x2003;Instruction set</a>
</p>


<p>
<a href="Instruction-set.html#autosec-183" class="tocsubsection" >
<span class="sectionnumber">5.1</span>&#x2003;Accessing memory</a>
</p>


<p>
<a href="Arithmetic.html#autosec-213" class="tocsubsection" >
<span class="sectionnumber">5.2</span>&#x2003;Arithmetic</a>
</p>


<p>
<a href="Jumps.html#autosec-237" class="tocsubsection" >
<span class="sectionnumber">5.3</span>&#x2003;Jumps</a>
</p>


<p>
<a href="Branches.html#autosec-246" class="tocsubsection" >
<span class="sectionnumber">5.4</span>&#x2003;Branches</a>
</p>


<p>
<a href="Logic.html#autosec-258" class="tocsubsection" >
<span class="sectionnumber">5.5</span>&#x2003;Logic</a>
</p>


<p>
<a href="Bit-manipulation.html#autosec-298" class="tocsubsection" >
<span class="sectionnumber">5.6</span>&#x2003;Bit manipulation</a>
</p>


<p>
<a href="System-control.html#autosec-317" class="tocsubsection" >
<span class="sectionnumber">5.7</span>&#x2003;System control</a>
</p>


<p>
<a href="Summary-instruction-set.html#autosec-326" class="tocsection" >
<span class="sectionnumber">6</span>&#x2003;Summary of instruction set</a>
</p>


<p>
<a href="Assembly-language-2.html#autosec-341" class="tocsection" >
<span class="sectionnumber">7</span>&#x2003;Assembly language 2</a>
</p>


<p>
<a href="Assembly-language-2.html#autosec-344" class="tocsubsection" >
<span class="sectionnumber">7.1</span>&#x2003;Programs, modules, and files</a>
</p>


<p>
<a href="Fixed-relocatable-values.html#autosec-357" class="tocsubsection" >
<span class="sectionnumber">7.2</span>&#x2003;Fixed and relocatable values</a>
</p>


<p>
<a href="Code-generators.html#autosec-366" class="tocsubsection" >
<span class="sectionnumber">7.3</span>&#x2003;Code generators</a>
</p>


<p>
<a href="Directives.html#autosec-381" class="tocsubsection" >
<span class="sectionnumber">7.4</span>&#x2003;Directives</a>
</p>


<p>
<a href="Object-code-linker.html#autosec-404" class="tocsection" >
<span class="sectionnumber">8</span>&#x2003;Object code and linker</a>
</p>


<p>
<a href="Object-code-linker.html#autosec-405" class="tocsubsection" >
<span class="sectionnumber">8.1</span>&#x2003;Object language</a>
</p>


<p>
<a href="Module-metadata.html#autosec-425" class="tocsubsection" >
<span class="sectionnumber">8.2</span>&#x2003;Module metadata</a>
</p>


<p>
<a href="Linker.html#autosec-428" class="tocsubsection" >
<span class="sectionnumber">8.3</span>&#x2003;Linker</a>
</p>


<p>
<a href="Booter.html#autosec-430" class="tocsubsection" >
<span class="sectionnumber">8.4</span>&#x2003;Booter</a>
</p>


<p>
<a href="Programming.html#autosec-433" class="tocsection" >
<span class="sectionnumber">9</span>&#x2003;Programming</a>
</p>


<p>
<a href="Programming.html#autosec-434" class="tocsubsection" >
<span class="sectionnumber">9.1</span>&#x2003;Structure of a program</a>
</p>


<p>
<a href="How-perform-commmon-tasks.html#autosec-437" class="tocsubsection" >
<span class="sectionnumber">9.2</span>&#x2003;How to perform commmon tasks</a>
</p>


<p>
<a href="Compilation.html#autosec-444" class="tocsubsection" >
<span class="sectionnumber">9.3</span>&#x2003;Compilation</a>
</p>


<p>
<a href="Errors-avoiding-finding-fixing.html#autosec-449" class="tocsubsection" >
<span class="sectionnumber">9.4</span>&#x2003;Errors: avoiding, finding, and fixing</a>
</p>


<p>
<a href="Installation.html#autosec-462" class="tocsection" >
<span class="sectionnumber">10</span>&#x2003;Installation</a>
</p>


<p>
<a href="Installation.html#autosec-463" class="tocsubsection" >
<span class="sectionnumber">10.1</span>&#x2003;Command line tools</a>
</p>


<p>
<a href="About-Sigma16.html#autosec-476" class="tocsection" >
<span class="sectionnumber">11</span>&#x2003;About Sigma16</a>
</p>


<p>
<a href="About-Sigma16.html#autosec-477" class="tocsubsection" >
<span class="sectionnumber">11.1</span>&#x2003;Copyright and license</a>
</p>


<p>
<a href="In-case-problems.html#autosec-479" class="tocsubsection" >
<span class="sectionnumber">11.2</span>&#x2003;In case of problems</a>
</p>


<p>
<a href="Release-notes.html#autosec-481" class="tocsubsection" >
<span class="sectionnumber">11.3</span>&#x2003;Release notes</a>
</p>


<p>
<a href="GPL3-license.html#autosec-495" class="tocsubsection" >
<span class="sectionnumber">11.4</span>&#x2003;GPL3 license</a>
</p>


</div>

</nav>

</div>


<main class="bodycontainer">


<section class="textbody">

<h1>Sigma16 User Guide</h1>

<!--MathJax customizations:-->


<div class="hidden">

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

</div>

<p>
<!--
...... subsection Code generators ......
-->
<h5 id="autosec-366"><span class="sectionnumber">7.3&#x2003;</span>Code generators</h5>
<a id="Sigma16UserGuide-autopage-366"></a>
<a id="Sigma16UserGuide-autofile-90"></a> <a id="sec:org869d712"></a>

<p>
Each line of source code is an assembly language statement. Unlike higher level languages, assembly language statements are not nested. There are three kinds of assembly language statement:
</p>

<ul style="list-style-type:none">

<li>
<p>
• <em>Comments</em> (blank lines, or lines beginning with ;)
</p>


</li>
<li>


<p>
• <em>Code</em> statements define instructions or constant data
</p>


</li>
<li>


<p>
• /Directives provide metadata but don’t generate any code
</p>
</li>
</ul>

<p>
An assembly language statement contains one or more fields. A field consists of non-space characters (with one exception: a space may appear in a string literal). Fields are separated from each other by one or more white space characters.
</p>

<ul style="list-style-type:none">

<li>
<p>
• Label. The label field is optional. If present, the label must be a name and it must begin in the first character of the line. If the first character is a space, then that line has no label.
</p>
</li>
<li>


<p>
• Operation. The operation field is an identifier that specifies an instruction or assembler directive. It must be preceded by one or more white space characters. Every statement (apart from a full line comment) must have an operation field.
</p>
</li>
<li>


<p>
• Operands. The operands field specifies operands for an instruction or arguments for assembly directives. There may be several operands, which must be separated by commas. Each type of statement (determined by the operation field) requires a
specific syntax for the operands. Most instructions and assembler directives require operands, but some do not.
</p>
</li>
<li>


<p>
• Comment. All text that either (1) follows white space after the operands field, or (2) follows a semicolon (;), is a comment, and is ignored by the assembler. If one or more of the other fields (label, operation, operands) is missing, the comment must
be preceded by a semicolon to prevent it from being interpreted as operands. The rule is: all text after a semicolon is a comment, and all text after white space following operands is a comment. A statement where the first non-space character is a
semicolon is a full line comment. If the statement has no operands, then all text after the operation field is a comment. It is good practice always to begin a comment with a semicolon.
</p>
</li>
</ul>
<!--
...... subsubsection Instructions ......
-->
<h6 id="autosec-367"><span class="sectionnumber">7.3.1&#x2003;</span>Instructions</h6>
<a id="Sigma16UserGuide-autopage-367"></a>


<a id="sec:org48471ac"></a>

<p>
Assembly language statements generally correspond to the instruction formats, but there is not an exact correspondence for several reasons:
</p>

<ul style="list-style-type:none">

<li>
<p>
• Sometimes an instruction is written in assembly language with a field omitted which exists in the machine language code but is ignored. For example, the instruction <b>cmp R1,R2</b> generates an RRR instruction, but the third operand field
is omitted because the instruction requires only one operand, not two. The assembler sets the unused operand to 0, but the machine ignores it. This is called a "don’t care" field in the instruction.
</p>
</li>
<li>


<p>
• Sometimes two instructions look the same in assembly language but use different machine language instruction formats. For example, <b>add R1,R2,R3</b> and <b>push R1,R2,R3</b> look similar, but <b>add</b> uses the RRR instruction
format and <b>push</b> uses the EXP instruction format. The reason for this is that there are not enough bits in the op field to accommodate all the instructions with three register operands, so an <b>expanding opcode</b> is used. Thus push is
represented with op=14, indicating EXP format, and the EXP variant is used for this instruction.
</p>
</li>
<li>


<p>
• The 4-bit fields are sometimes used to denote a register from the register file (R3), or a control register (mask), or a constant . In assembly language the constants are written just as a number (e.g. shiftl R1,R2,5). Control registers are written by
name rather than their number in the control register file (e.g. getctl R3,mask).
</p>
</li>
<li>


<p>
• Some assembly language statements are <b>pseudoinstructions</b>. These are special cases of more general instructions. For example, <b>and</b> is a pseudoinstruction which generates a <b>logicw</b> instruction specialised to perform a
logical and.
</p>
</li>
</ul>

<p>
Table: <b>Assembly language statement formats</b>
</p>
<div class="center">
<table>

<tr style="display:none"><th>.</th></tr>

<tr>
<td class="tdl">afmt</td>
<td class="tdl">operand general form</td>
<td class="tdl">example</td>
<td class="tdl">notes</td>
</tr>

<tr class="hline">
<td class="tdl">RRR</td>
<td class="tdl">Rd,Ra,Rb</td>
<td class="tdl">add R1,R2,R3</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl">RR</td>
<td class="tdl">Ra,Rb</td>
<td class="tdl">cmp R1,R2</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl">RX</td>
<td class="tdl">Rd,disp[Ra]</td>
<td class="tdl">load R1,xyz[R2]</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl">kX</td>
<td class="tdl">k,disp[Ra]</td>
<td class="tdl">jumpc0 6,loop[R2]</td>
<td class="tdl">0 <= k <= 15</td>
</tr>

<tr>
<td class="tdl">RRRk</td>
<td class="tdl">Rd,Ra,Rb,K[Re]</td>
<td class="tdl">save R1,R5,3[R14]</td>
<td class="tdl">0 <= K <= 255</td>
</tr>

<tr>
<td class="tdl">RRk</td>
<td class="tdl">Ra,Rb,k</td>
<td class="tdl">shiftl R1,R2,5</td>
<td class="tdl">0 <= k <= 15</td>
</tr>

<tr>
<td class="tdl">Rkkkk</td>
<td class="tdl">Rd,e,f,g,h</td>
<td class="tdl">logicr R1,</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl">RkkRk</td>
<td class="tdl">Ra,j,n,Rb,k</td>
<td class="tdl">extract</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl">RC</td>
<td class="tdl">Rc,Rd</td>
<td class="tdl">putctl vect,R4</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl"></td>
<td class="tdl"></td>
<td class="tdl"></td>
<td class="tdl"></td>
</tr>

</table>

</div>
<div class="center">
<table>

<tr style="display:none"><th>.</th></tr>

<tr>
<td class="tdl">Label</td>
<td class="tdl">Statement</td>
<td class="tdl">Operands</td>
<td class="tdl">Purpose</td>
</tr>

<tr class="hline">
<td class="tdl">optname</td>
<td class="tdl">data</td>
<td class="tdl">exprs</td>
<td class="tdl">generate word for each exp</td>
</tr>

<tr>
<td class="tdl"></td>
<td class="tdl">RRRop</td>
<td class="tdl">r,r,r</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl"></td>
<td class="tdl">RXop</td>
<td class="tdl">r,exp[r]</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl"></td>
<td class="tdl">RRop</td>
<td class="tdl">r,r</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl"></td>
<td class="tdl">Rop</td>
<td class="tdl">r</td>
<td class="tdl"></td>
</tr>

<tr>
<td class="tdl"></td>
<td class="tdl">RRKKop</td>
<td class="tdl">r,r,k,k</td>
<td class="tdl"></td>
</tr>

</table>

</div>
<div class="center">
<table>

<tr style="display:none"><th>.</th></tr>

<tr>
<td class="tdl">Asm</td>
<td class="tdl">instruction</td>
<td class="tdl">operands</td>
<td class="tdl">ML formats</td>
</tr>

<tr class="hline">
<td class="tdl">RRR</td>
<td class="tdl">add</td>
<td class="tdl">Rd,Ra,Rb</td>
<td class="tdl">RRR</td>
</tr>

<tr>
<td class="tdl">RX</td>
<td class="tdl">lea</td>
<td class="tdl">Rd,disp[Ra]</td>
<td class="tdl">RX</td>
</tr>

<tr>
<td class="tdl">RR</td>
<td class="tdl">inv</td>
<td class="tdl">Rd,Ra</td>
<td class="tdl">RRR (b ignored), RREXP</td>
</tr>

<tr>
<td class="tdl">JX</td>
<td class="tdl">jump</td>
<td class="tdl">disp[Ra]</td>
<td class="tdl">RX (b ignored)</td>
</tr>

<tr>
<td class="tdl">KX</td>
<td class="tdl">jumpc0</td>
<td class="tdl">d,disp[Ra]</td>
<td class="tdl">RX (d is constant)</td>
</tr>

<tr>
<td class="tdl">RRK</td>
<td class="tdl">shiftl</td>
<td class="tdl">Rd,Ra,k</td>
<td class="tdl">EXP</td>
</tr>

<tr>
<td class="tdl">RkkRk</td>
<td class="tdl">extract</td>
<td class="tdl">Rd,e,f,Rg,h</td>
<td class="tdl">EXP</td>
</tr>

<tr>
<td class="tdl">RCEXP</td>
<td class="tdl">getctl</td>
<td class="tdl">Re,Cf</td>
<td class="tdl">EXP</td>
</tr>

</table>

</div>

<p>
An EXP instruction may use the fields op, d, ab, e, f, g, h. The g and h fields can be combined into a single 8-bit field gh All EXP instructions combine the a and b fields into a single 8-bit field called ab. Some EXP instructions combine the g and h
fields into a single 8-bit field called gh. The EXP format has the following variants.
</p>

<ul style="list-style-type:none">

<li>
<p>
• The RREXP format takes two register operands, which are in the e and f fields of the second word. The d field of the first word and the g and h fields of the second word are ignored (the assembler will set these to 0). Any RREXP instruction
could be reprsented as RRR, but there are only a few RRR opcodes avaiable, so uncommon instructions that require two registers are represented as RREXP. Example: <b>execute R5,R6</b> is RREXP.
</p>
</li>
<li>


<p>
• The RCEXP format takes two register operands; the first is a general register and the second is a control register. An example of the operand field is <b>R3,mask</b>. The operands are in the e and f fields of the second word. The d field of the
first word and the g and h fields of the second word are ignored (the assembler will set these to 0.) The first operand is an element of the register file (for example, R4). The second operand is a control register, which is specified by a 4-bit number. In
assembly language, we normally refer to the control registers by name rather than number, to make it easier to remember which is which. For example, <b>getctl R3,status</b> has RCEXP format.
</p>
</li>
<li>


<p>
• The RRREXP format takes three register operands, which are in the f, g, and h fields of the second word. An example of the operand field is &#x00024;R1,R2,R3*. The d field of the first word and the e field of the second word are ignored (the
assembler will set these to 0). The RRREXP instructions would be a natural fit for the RRR format, but there are not enough RRR opcodes available, so the EXP format is used to expand the number of instructions that can be represented. For
example, <b>push R5,R8,R9</b> has RRREXP format.
</p>
</li>
<li>


<p>
• The RRKEXP format takes two register operands and a 4-bit constant number. An example of the operand field is <b>R1,R2,13</b>. The register operands are in the f and g fields of the second word, and constant is in the h field of the second
word. The d field of the first word and the e field of the second word are ignored (the assembler sets these to 0). For example, <b>shiftr R3,R6,7</b> has RRKEXP format.
</p>
</li>
<li>


<p>
• The RRKKEXP format takes two register operands and two 4-bit constant binary number operands. The register operands are in the e and f fields of the second word, while the two constants are in the g and h fields. The d field of the first word is
ignored (the assembler sets it to 0).
</p>
</li>
<li>


<p>
• The RRXEXP format takes two register operands as well as a memory address specified with an 8-bit offset and index register. Thus these instructions require three registers to be specified, as well as the offset. Thus every bit of both instruction
words is needed to represent an RRXEXP format instruction. In assembly language, the memory address is written as <b>offset[Rh]</b> where <b>offset</b> is an -bit binary number and Rh is a register. The effective memory address is
<b>offset+Rh</b>. This is similar to ordinary memory addresses; the only difference is that it uses an 8-bit offset rather than a 16-bit displacement. For example, <b>save R1,R9,2[R14]</b> has RRKEXP format.
</p>
</li>
</ul>

<p>
Expressions, values and relocatables
</p>

<ul style="list-style-type:none">

<li>
<p>
• An expression is syntax: 23, -5, &#x00024;b23e, struc+5, arrEnd-arrStart
</p>


</li>
<li>


<p>
• A value denotes a word (it is a number) and is the result of evaluating an expression
</p>


</li>
<li>


<p>
• A value is marked as either relocatable or fixed
</p>


</li>
<li>


<p>
• Expressions may occur in
</p>
<ul style="list-style-type:none">


<li>
<p>
– Displacement field of an assembly language statement; the value of the expression is placed in the displacement field of the corresponding machine language instruction.
</p>


</li>
<li>


<p>
– If a displacement value is relocatable, its address is recorded in the list of addressess of words to be relocated
</p>


</li>
<li>


<p>
– Right hand side of an equ statement. The value may be fixed or relocatable. The name (the left hand side) is defined as a new identifier, the definition line is the line containing the equ, the value is the evaluation of
the right hand side, which may be either fixed or relocatable. Identifiers used in the expression on the RHS have the line number included in their usage lines.
</p>


</li>
<li>


<p>
– But identifiers that appear in an expression (even if relocatable) are not recorded in the relocation list; only displacements are placed in the relocation list.
</p>
</li>
</ul>
</li>
</ul>

<ul style="list-style-type:none">

<li>
<p>
1. Instruction set <a id="sec:org0a46acf"></a>
</p>
<p>
The following sections describe the instructions in groups organized by their function. Some of the groups contain instructions with different formats. From the programmer’s perspective the function is more important, so these groups are useful in
finding the right instruction to use. (From the perspective of designing a digital circuit to impleemnt the architecture, the format is essential.)
</p>
</li>
</ul>

</section>

</main>

</div>


<nav class="botnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>

</body>
</html>
